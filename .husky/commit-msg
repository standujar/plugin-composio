#!/bin/sh

commit_msg=$(cat "$1")

type=$(echo "$commit_msg" | awk 'match($0, /^(build|ci|feat|fix|perf|refactor|style|docs|test|chore|revert|workflow|wip|security)/) {print substr($0, RSTART, RLENGTH)}')

if [ -z "$type" ]; then
    echo "âŒ Invalid commit type!"
    echo "Allowed types:" 
    echo "â€¢ build ğŸ—ï¸"
    echo "â€¢ ci ğŸ‘·"
    echo "â€¢ feat âœ¨"
    echo "â€¢ fix ğŸ›"
    echo "â€¢ perf âš¡"
    echo "â€¢ refactor â™»ï¸"
    echo "â€¢ style ğŸ’„"
    echo "â€¢ docs ğŸ“"
    echo "â€¢ test ğŸ§ª"
    echo "â€¢ chore ğŸ”§"
    echo "â€¢ revert âª"
    echo "â€¢ workflow ğŸ“‹"
    echo "â€¢ wip â³"
    echo "â€¢ security ğŸ”’"
    echo ""
    echo "Expected format: <type>(<scope>): <subject>"
    echo "Example: feat(auth): add email login"
    exit 1
fi

echo "âœ… Commit message is valid!"

exit 0
